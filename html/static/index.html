<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>OPEC Visualisation Portal Prototype</title>

<!-- ============================ Now for the styling ============================ -->

<!-- Default styling for web app plus overrides of OpenLayers and jQuery UI styles -->
<link rel="stylesheet" type="text/css" href="css/OPECPortal.css" />

<!-- ============================ JavaScript libraries ============================ -->
<!-- Latest jQuery from jQuery.com -->
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-migrate-1.1.1.min.js"></script>

<!-- The latest jQuery UI from jqueryui.com -->
<script type="text/javascript" src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>

<!-- OpenLayers Map Code-->
<script type="text/javascript" src="js-libs/OpenLayers/OpenLayers.js"></script>

<!-- Flotr2 -->
<script type="text/javascript" src="js-libs/Flotr2/js/flotr2.min.js"></script>

<!-- http://forum.jquery.com/topic/expand-all-zones-for-an-accordion#14737000002919405 -->
<!-- <script type="text/javascript" src="js-libs/multiAccordion.js"></script> -->

<!-- http://code.google.com/p/jquery-multi-open-accordion -->
<!-- <script type="text/javascript" src="js-libs/jquery.multi-open-accordion-1.5.3.js"></script> -->

<!-- http://medialize.github.com/jQuery-contextMenu/ -->
<!-- <script type="text/javascript" src="js-libs/jquery-contextMenu/js/jquery-contextMenu.js"></script> -->

<!-- https://github.com/jboesch/Gritter -->
<!-- <script type="text/javascript" src="js-libs/jquery-gritter/js/jquery.gritter.js"></script> -->

<!-- https://github.com/michael/multiselect -->
<!-- <script type="text/javascript" src="js-libs/jquery-multiselect/js/jquery.multiselect.js"></script> -->

<!-- jQuery UI dialog extension -->
<!-- <script type="text/javascript" src="js-libs/jquery-dialogextend/js/jquery.dialogextend.1.1.0.js"></script> -->

<!-- Cesium -->
<script type="text/javascript" src="js-libs/Cesium/js/Cesium.js"></script>

<!-- O2C -->
<!--<script type="text/javascript" src="js-libs/O2C/js/O2C.js"></script>-->

<!-- D3 -->
<!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.2.2/d3.js"></script> -->
<!-- <script src="js-libs/d3.js"></script> -->
<script src="http://d3js.org/d3.v3.js"></script>

<!-- mustache -->
<script type="text/javascript" src="js-libs/mustache/jquery.mustache.js"></script>

<!-- heatmapjs -->
<script type="text/javascript" src="js-libs/heatmapjs/heatmap.js"></script>
<script type="text/javascript" src="js-libs/heatmapjs/heatmap-openlayers.js"></script>

<!-- filtrify -->
<!-- <script type="text/javascript" src="js-libs/filtrify/js/filtrify.js"></script> -->

<!-- quicksand -->
<!-- <script type="text/javascript" src="js-libs/quicksand/js/quicksand.js"></script> -->

<!-- dialog -->
<!-- <script type="text/javascript" src="js-libs/dialog.js"></script> -->

<!-- Custom JavaScript -->
<script type="text/javascript" src="OPECPortal.js"></script>

<!-- =================================== Templates =================================== -->
<script type="text/html" id="opec-template-layer">
   {{! List of used variables for this template:
      name - The name of the layer
      loader - Show ajax loader (true/false)
      checkbox - Show checkbox (true/false)
      visibility - Is the layer visible
      displayTitle - The name to show     
   }}
   <li id="{{name}}" class="opec-layer">
      <img src="img/ajax-loader.gif"/>
      <input type="checkbox" {{#visibility}}checked="yes"{{/visibility}} name="{{name}}" value="{{name}}" />
      {{displayTitle}} 
      <a id="layer-exclamation" href="#">
         <img src="img/exclamation_small.png"/>
      </a>
      <!--<a>
         <span class="ui-icon ui-icon-circle-close">close</span>
      </a>-->
   </li>
</script>
<!-- Metadata Window -->
<script type="text/html" id="opec-template-metadataWindow">
   {{! List of used variables for this template:
      id - A unique id of the layer whos metadata is to be displayed.
      displayTitle - What will be shown to the user to identifiy the window.
      source - The source of the data that makes up the layer.
      northBoundLat - North Bound Latitude.
      eastBoundLon - East Bound Longitude.
      southBoundLat - South Bound Latitude.
      westBoundLon - West Bound Longitude.
      addDateRange - Returns true if the layer has temporal data.
      firstDate - The first avaliable date for the layer.
      lastDate - The last avaliable date for the layer.
      productAbstract - A description of the layer.
   }}
   <div id="metadata-{{id}}" class="tt" title="Metadata - {{displayTitle}}">          
      <div>
         <label>Source: {{source}}</label>
      </div>
      <div>
         <label>Name: {{displayTitle}}</label>
      </div>
      <div>
         <span>
            BoundingBox:
            <label style="color: green">{{northBoundLat}}</label>
            N,
            <label style="color: blue">{{eastBoundLon}}</label>
            E,
            <label style="color: green">{{southBoundLat}}</label>
            S,
            <label style="color: blue">{{westBoundLon}}</label>
            W
         </span>
      </div>
      {{#addDateRange}}
      <div>
         <label>Date Range: {{firstDate}} to {{lastDate}} </label>
      </div>
      {{/addDateRange}}
      <div>
         <label>Abstract: {{productAbstract}}</label>
      </div>
   </div>
</script>
<!-- Scalebar Window -->
<script type="text/html" id="opec-template-scalebarWindow">
   {{! List of used variables for this template:
      name - A unique id of the layer whos metadata is to be displayed.
      displayTitle - What will be shown to the user to identifiy the window.
      url - The url of the scalebar picture.
   }}
   <div id="scalebar-{{name}}" class="scalebar unselectable tt" title="Scalebar - {{displayTitle}}">
      <img src="{{url}}" alt="Scalebar" />
      <div id="{{name}}-range-slider"></div>
      <div>
         <label for="{{name}}-max">Maximum Value: </label>
      </div>
      <div class="scalebar-max">
         <input id="{{name}}-max" title="The maximum value to be used" type="text" name="{{name}}-max" />
      </div>
      <div id="{{name}}-scale" class="scalebar-scale">
         <input type="button" name="{{name}}-scale-button" title="Add 25% to top and bottom of the slider" value="Recalculate Scale" />
      </div>
      <div id="{{name}}-log" class="scalebar-log">
         <input type="checkbox" name="{{name}}-log-checkbox" title="Use Logarithmic Scale" />
         <label for="{{name}}-logarithmic">Logarithmic Scale</label>
      </div>
      <div id="{{name}}-reset" class="scalebar-reset">
         <input type="button" name="{{name}}-reset-button" title="Reset the scale to the default values" value="Reset Scale" />
      </div>
      <div>
         <label for="{{name}}-min">Minimum Value: </label>
      </div>
      <div class="scalebar-min">
         <input id="{{name}}-min" title="The minimum value to be used" type="text" name="min" />
      </div>
   </div>
</script>
<!-- Graph Creator Window-->
<script type="text/html" id="opec-template-graphCreatorWindow">
   {{! List of used variables for this template:
      advanced - Show advanced options (true/false)
   }}
   <div id="graphCreator" class="unselectable tt" title="Graph Creator">
      <div class="ui-control">
         <div>
            <label for="graphcreator-gallery-label">Gallery:</label>
         </div>
         <div id="graphcreator-gallery">
            <input type="radio" name="gallery" value="timeseries" id="timeseries" title="Returns a time series with mean, median, max, min and STD" checked>
            <label for="timeseries">Timeseries</label>
            <input type="radio" name="gallery" value="hovmollerLat" id="hovmollerLat" title="Returns a hovmöller graph with Latitude on the Y Axis">
            <label for="hovmollerLat">Hovmöller Latitude</label>
            <input type="radio" name="gallery" value="hovmollerLon" id="hovmollerLon" title="Returns a hovmöller graph with longitude on the X Axis">
            <label for="hovmollerLon">Hovmöller Longitude</label>
            <input type="radio" name="gallery" value="histogram" id="histogram" title="Returns a histogram">
            <label for="histogram">Histogram</label>
            <!--<input type="radio" name="gallery" value="raw" title="Not for normal use (gets the raw data)"><label for="raw">raw</label>
            <input type="radio" name="gallery" value="test" title="Not for normal use (test new queries)"><label for="test">test</label>
            <input type="radio" name="gallery" value="error" title="Generates errors, used testing error handling"><label for="error">error</label> -->
         </div>
         <h3 id="data-inputs-header" class="ui-control-header ui-helper-reset">
            <span class="ui-icon ui-icon-triangle-1-s"></span>
            <a href="#">Data</a> 
         </h3>
         <div id="data-inputs">
            <div>
               <label for="graphcreator-baseurl-label">Base URL:</label>
            </div>
            <div>
               <input id="graphcreator-baseurl" title="Base URL of the WCS server" placeholder="WCS URL" type="text" name="graphcreator-path" />
            </div>
            <div>
               <label for="graphcreator-coverage-label">Coverage:</label>
            </div>
            <div>
               <input id="graphcreator-coverage" title="Name of the Coverage" placeholder="Name of the Coverage" type="text" name="graphcreator-coverage" />
               <input id="graphcreator-coverage-button" title="Get the top selected layer" type="button" name="graphcreator-coverage-button" value="Get Top Layer" />
            </div>
         </div>
      </div>
      <div class="ui-control">
         <h3 id="histogram-inputs-header" class="ui-control-header ui-helper-reset">
            <span class="ui-icon ui-icon-triangle-1-s"></span>
            <a href="#">Histogram Inputs</a>
         </h3>
         <div id="histogram-inputs">
            <div>
               <label for="graphcreator-bins-label">Bins:</label>
            </div>
            <div>
               <input id="graphcreator-bins" title="Comma Separated Bins" placeholder="example: 0,2.5,5,7.5,10" type="text" name="graphcreator-bins"/>
            </div>
         </div>
      </div>
      {{#advanced}}
      <div class="ui-control">
         <h3 id="advanced-inputs-header" class="ui-control-header ui-helper-reset">
            <span class="ui-icon ui-icon-triangle-1-s"></span>
            <a href="#">Area and Time of Interest</a>
         </h3>
         <div id="advanced-inputs">
            <div>
               <label for="graphcreator-range">Range:</label>
               <select name="graphcreator-range" id="graphcreator-range"><select>
            </div>
            <div>
               <label for="graphcreator-time">Date:</label>
            </div>
            <div>
               <input id="graphcreator-time" title="You can use also choose time&#47;date ranges" type="text" placeholder="yyyy-mm-dd" size="10" name="graphcreator-time"/>
               <label> to </label>
               <input id="graphcreator-time2" title="You can use also choose time&#47;date ranges" type="text" placeholder="yyyy-mm-dd" size="10" name="graphcreator-time2"/>
            </div>
            <div>
               <label for="graphcreator-bbox">Bbox:</label>
            </div>
            <div>
               <input id="graphcreator-bbox" title="Bbox in lon,lat,lon,lat format" placeholder="lon,lat,lon,lat" type="text" name="graphcreator-bbox"/>
            </div>
         </div>
      </div>
      {{/advanced}}
      <div id="graphcreator-generate">
         <input type="button" title="Generate a graph from a WCS request" name="graphcreator-generate-button" value="Generate Graph" />
         <img src="img/ajax-loader.gif"/> 
      </div>
   </div>
</script>
<!-- Item on the layer selection window -->
<script type="text/html" id="opec-template-selector-item">
    <li class="opec-unselected ui-state-default" data-provider="{{provider}}" data-title="{{title}}" data-id="{{id}}" data-name="{{name}}">
       <strong>{{name}}</strong>
       <a href="#"><span class="ui-corner-all ui-icon ui-icon-plus"></span></a>
       <span style="display:none;">Abstract: <i>{{abstract}}</i></span>
    </li>
</script>
<!-- ====================================================================== -->

</head>
<body>
   <!-- CSS check and info for screen readers -->
   <div id="nocss-info">
      <h1>OPEC Portal</h1>
      <!-- Info for screen readers and any bots. Should show up on search results -->
      <span>
         Welcome to the OPEC (Operational Ecology) Marine Ecosystem Forecasting Portal. The OPEC project will develop 
         and evaluate ecosystem forecast tools to help assess and manage the risks posed by human activities on the 
         marine environment, helping to improve the ability to predict the “health” of European marine ecosystems.
      </span>
      <div class="css-check">
         This website requires css to work. Please enable it in your browser.
      </div>
   </div>
   <!-- JavaScript check -->
   <noscript>
      <div id="noscript-warning">
         This website requires JavaScript to work. Please enable it in your browser.
      </div>
   </noscript>

   <!-- The Map -->
   <div id="map"></div>
   <!-- The Top Toolbar -->
   <div id="topToolbar" class="toolbar unselectable tt">
      <ul>
         <li id="panZoom">
            <input type="radio" id="pan" name="radio" value="pan" checked="checked" />
            <label class="iconBtn" for="pan" title="Pan the Map: Keep the mouse button pressed and drag the map around."></label>
            <input type="radio" id="zoomIn" name="radio" value="zoomIn"/>
            <label class="iconBtn" for="zoomIn" title="Zoom In: Click in the map to zoom in or drag a rectangle to zoom into that selection."></label>
            <input type="radio" id="zoomOut" name="radio" value="zoomOut" />
            <label class="iconBtn" for="zoomOut" title="Zoom Out: Click in the map to zoom out or drag a rectangle to zoom the map out into that selection."></label>
         </li>
         <li class="divider"></li>
         <li>
            <!-- Using fieldsets as no easy CSS alternative -->
            <fieldset>
               <legend>View Date</legend>
               <input size="10" type="text" name="viewDate" id="viewDate" placeholder="dd-mm-yyyy" />
            </fieldset>
         </li>
         <li class="divider"></li>
         <li>
            <!-- Using fieldsets as no easy CSS alternative -->
            <fieldset>
               <legend>Quick Region</legend>
               <select class="opec-quickRegion-select ui-corner-all" id="quickRegion" name="Quick Region">
               </select>
            </fieldset>
         </li>
         <li class="divider"></li>
         <li id="opec-toolbar-actions" class="opec-toolbar-buttonpane">
            <button id="mapInfoToggleBtn"></button>
            <input type="checkbox" id="shareMapToggleBtn" /><label class="opec-iconBigBtn" for="shareMapToggleBtn" title="Open Share Panel"></label>
            <button id="layerPreloader"></button>
            <input type="checkbox" id="opec-button-3d" /><label class="opec-iconBigBtn" for="opec-button-3d" title="Go To 3D Mode!"></label>
            <button id="infoToggleBtn"></button>
         </li>
      </ul>
      <div class="togglePanel">
         <button></button>
      </div>
   </div>
   <!-- The Left Panels -->
   <a class="trigger triggerL unselectable" href="#">Layers</a>
   <div class="panel lPanel unselectable">
      <h3 id="layerLbl">Data Layers</h3>
      <div id="layerAccordion" class="ui-helper-reset">
         <div id="opec-triggerL-toolbar" class="panel-toolbar ui-helper-reset">
            <ul>
               <li class="opec-tab-group ui-corner-top lPanel-buttonSet">
                  <button id="opec-lpanel-tab-operational" class="opec-tab" href="#opec-lPanel-operational">Operational</button>
                  <button id="opec-lpanel-tab-reference" class="opec-tab" href="#opec-lPanel-reference">Reference</button>
                  <button id="opec-lpanel-tab-options" class="opec-tab" href="#lpanel-base-layers">Options</button>
               </li>
               <li id="triggerL-buttonset" class="lPanel-buttonSet ui-corner-top">
                  <button id="triggerL-add-accordion" class="panel-button"></button>
                  <!-- <button id="triggerL-remove-accordion" class="panel-button"></button> -->
               </li>
               <li id="triggerL-group-creation" style="display: none; margin-top: 4px;">
                  <input id="triggerL-enter-group-name" title="Group Name" type="text" placeholder="enter group name here" />
               </li>
            </ul>       
         </div>
         <div id="opec-lPanel-content" class="ui-corner-all">
            <div id="opec-lPanel-operational" class="ui-corner-top opec-tab-content opec-tab-active"></div>
            <div id="opec-lPanel-reference" class="ui-corner-top opec-tab-content" style="display: none;"></div>
            <div id="lpanel-base-layers" class="opec-tab-content" style="display: none;">
               <div id="baseLayers">
                  <fieldset>
                     <legend>Base Layer</legend>
                     <select class="ui-corner-all" id="baseLayer" name="Base Layer">
                     </select>
                  </fieldset>
                  <!-- Quick Region -->
                  <fieldset>
                     <legend>Quick Regions</legend>
                     <select class="opec-quickRegion-select ui-corner-all"></select>
                     
                     <div style="clear: both;"> </div>
                     
                     <button class="opec-quickRegion-remove">Remove selected region</button>
                     
                     <div style="clear: both;"> </div>
                  </fieldset>
                  
                  <fieldset>

                     <legend>Edit Regions:</legend>
                     <div style="clear: both;"> </div>
                     
                     <!-- Quick Region Name -->
                     <label for="opec-quickRegion-name">Region Name:</label>
                     <input type="text" class="opec-quickRegion-name" name="opec-quickRegion-name"/>
                     
                     <div style="clear: both;"> </div>
                     
                     <!-- Quick Region Bounds -->
                     <label for="opec-quickRegion-left">Left:</label>
                     <input type="text" class="opec-quickRegion-left" name="opec-quickRegion-left"/>
                     
                     <div style="clear: both;"> </div>
                     
                     <label for="opec-quickRegion-bottom">Bottom:</label>
                     <input type="text" class="opec-quickRegion-bottom" name="opec-quickRegion-bottom"/>
                     
                     <div style="clear: both;"> </div>
                     
                     <label for="opec-quickRegion-right">Right:</label>
                     <input type="text" class="opec-quickRegion-right" name="opec-quickRegion-right"/>
                     
                     <div style="clear: both;"> </div>
                     
                     <label for="opec-quickRegion-top">Top:</label>
                     <input type="text" class="opec-quickRegion-top" name="opec-quickRegion-top"/>
                  </fieldset>  
                  
                  <button class="opec-quickRegion-reset">Reset</button>
                  <button class="opec-quickRegion-save">Save</button> 
                  <button class="opec-quickRegion-add">Add as new region</button>
               </div>
            </div>
         </div>
      </div>
      <div style="clear: both;"> </div>
   </div>
   <!-- The Right Panels -->
   <a class="trigger triggerR unselectable" href="#">Data</a>
   <div class="panel rPanel unselectable">
      <h3 id="dataLbl">Data Analysis</h3>     
      <div id="dataAccordion" class="ui-helper-reset">
         <div id="opec-triggerR-toolbar" class="panel-toolbar ui-helper-reset">
            <!-- Using fieldsets as no easy CSS alternative -->
            <fieldset>
               <legend>Data Selection Tools</legend>
               <ul>
                  <!-- Placeholder ROI radio buttons -->
                  <li id="ROIButtonSet">
                     <input type="radio" id="point" name="radio" value="point" />
                        <label class="iconBtn" for="point" title="Draw Point: Click in the map to draw a point as a region of interest centred on the click point."></label>
                     <input type="radio" id="box" name="radio" value="box"/>
                        <label class="iconBtn" for="box" title="Draw Box: Click and drag on the map to draw a rectangle as a region of interest with the click point at its top-left."></label>
                     <input type="radio" id="circle" name="radio" value="circle" />
                        <label class="iconBtn" for="circle" title="Draw Circle: Click and drag on the map to draw a circle as a region of interest with the click point at its centre."></label>
                     <input type="radio" id="polygon" name="radio" value="polygon" />
                        <label class="iconBtn" for="polygon" title="Draw Polygon: Click repeatedly on the map to draw a polygon as a region of interest. Double-click to finish drawing the polygon"></label>
                  </li>
               </ul>
            </fieldset>
         </div>
         <div id="opec-panel-toolbar" class="ui-corner-top panel-buttonSet">
            <ul>
               <li class="opec-tab-group ui-corner-top">
                  <button id="opec-button-selection" class="opec-tab" href="#opec-tab-selection">Selection</button>
                  <button id="opec-button-analyses" class="opec-tab" href="#opec-tab-analyses">Analyses</button>
                  <button id="opec-button-export" class="opec-tab" href="#opec-tab-export">Data Export</button>
               </li>
            </ul>
         </div>
         <div id="opec-rPanel-content" class="ui-corner-all">
            <div id="opec-tab-selection" class="opec-tab-content ui-corner-top opec-tab-active">
               <h3><a href="#">Current R.O.I.</a></h3>
               <div id="dispROI"><span>No Selection</span></div>
            </div>
            <div id="opec-tab-analyses" class="opec-tab-content ui-corner-top" style="display: none;">
                  <h3>Graphing</h3>
                  <div id="opec-graphing">  
                  </div>
               </div>
            <div id="opec-tab-export" class="opec-tab-content ui-corner-top" style="display: none;">
               <h3><a href="#">Data Tools</a></h3>
               <div id="dataTools">
                  <div class="opec-list"><b>Selected Layer: </b> None</div>
                  <div class="opec-list"><b>Selected Bbox: </b> None</div>
                  <div class="opec-list"><b>Selected Format: </b>
                     <select id="opec-dataexport-format" title="Format you wish to the data to be returned in">
                        <option value="NetCDF3" title="Returns a netcdf3 file">NetCDF3</option>
                     </select>
                  </div>
                  <a href="#" target="_new">Download Data</a>
               </div>
            </div>
         </div>
      </div>
      <div style="clear: both;"> </div>
   </div>
   <!-- Share Options Panel, appears after the share options button has been clicked  -->
   <div class="toolbar" id="shareOptions">
   	<h3>Share</h3>
      <div>
         <label class="iconBtn" for="shareEmail" title="Please enter your email"></label>
         <input type="text" name="shareEmail" placeholder="example@example.com" id="shareEmail" />
         <button>Save State</button>
      </div> 
   </div>
   
   <!-- CLONE: change branding here -->
   <div id="info" class="unselectable" title="Information">
      <a href="http://www.marineopec.eu" target="_new" name="OpEc Main Web Site" rel="external"> <img src="img/OpEc_small.png" alt="OpEc (Operational Ecology) Logo" /></a>
      <a href="http://cordis.europa.eu/fp7/home_en.html" target="_new" name="European Union Seventh Framework Programme" rel="external"> <img src="img/fp7_small.png" alt="European Union FP7 Logo" /></a>
      <p>&copy;2013 PML Applications Ltd<br/>
      EU Project supported within DG SPACE for the 7th Framework Programme for Cooperation.</p>
      <div style="clear: both;"> </div>
   </div>
   <!-- ====================================================================== -->
   
   <!-- Map Info Dialog -->
   <div id="mapInfo" title="MapInfo">
      <div>
         <span id="latlng"></span>
      </div>
      <div>
         <span id="mapInfo-Projection"></span>
      </div>
   </div>
   <!-- Layer Selection Dialog -->
   <!-- <div id="layerSelection" class="layer-selection unselectable tt" title="Layer Selection">
      <span>Please select which layers you would like to use with the map. You can change these layers at any time.</span>
      <div id="layers"></div>
   </div> -->
   
   <div id="opec-layerSelection" class="layer-selection unselectable tt" title="Layer Selection">
      <span>Please select which layers you would like to use with the map. You can change these layers at any time.</span>
      <ul>
         <li class="opec-tagMenu"></li>       
         <li class="opec-selectable">
            <ul></ul>
         </li>       
      </ul>
   </div>
   
   <!-- D3 Timeline -->
   <div id="timeline" class="timelineDiv">
      <div class="togglePanel">
         <button></button>
      </div>
   </div>
   <div id="dThree" title="D3 Test"></div>
</body>
</html>
